// このファイルは自動生成です（Python -> Kotlin embedded mode）。

// Kotlin 埋め込み実行向け Python ランタイム補助。

import java.io.File
import java.nio.file.Files
import java.nio.file.Path
import java.util.Base64
import java.util.UUID

/**
 * Base64 で埋め込まれた Python ソースコードを一時ファイルに展開し、python3 で実行する。
 */
object PyRuntime {
    /**
     * @param sourceBase64 Python ソースコードの Base64 文字列。
     * @param args Python スクリプトへ渡す引数配列。
     * @return python プロセスの終了コード。失敗時は 1 を返す。
     */
    @JvmStatic
    fun runEmbeddedPython(sourceBase64: String, args: Array<String>): Int {
        val sourceBytes: ByteArray = try {
            Base64.getDecoder().decode(sourceBase64)
        } catch (ex: IllegalArgumentException) {
            System.err.println("error: failed to decode embedded Python source")
            return 1
        }

        val tempFile: Path = try {
            val name = "pytra_embedded_${UUID.randomUUID()}.py"
            val p = File(System.getProperty("java.io.tmpdir"), name).toPath()
            Files.write(p, sourceBytes)
            p
        } catch (ex: Exception) {
            System.err.println("error: failed to write temporary Python file: ${ex.message}")
            return 1
        }

        val command = mutableListOf("python3", tempFile.toString())
        command.addAll(args)
        // Python 製補助モジュールを import できるよう、src を PYTHONPATH に追加する。
        val env = mutableMapOf<String, String>()
        env.putAll(System.getenv())
        val currentPyPath = env["PYTHONPATH"]
        env["PYTHONPATH"] = if (currentPyPath.isNullOrEmpty()) "src" else "src:$currentPyPath"
        val process: Process = try {
            ProcessBuilder(command)
                .apply { environment().putAll(env) }
                .inheritIO()
                .start()
        } catch (ex: Exception) {
            System.err.println("error: failed to launch python3: ${ex.message}")
            try {
                Files.deleteIfExists(tempFile)
            } catch (_: Exception) {
            }
            return 1
        }

        val code = process.waitFor()
        try {
            Files.deleteIfExists(tempFile)
        } catch (_: Exception) {
        }
        return code
    }
}

class pytra_15_mini_language_interpreter {
    companion object {
        // 埋め込み Python ソース（Base64）。
        private const val PYTRA_EMBEDDED_SOURCE_BASE64: String = "ZnJvbSBkYXRhY2xhc3NlcyBpbXBvcnQgZGF0YWNsYXNzCmZyb20gdGltZSBpbXBvcnQgcGVyZl9jb3VudGVyCgoKIyDlrZflj6Xop6PmnpDnlKjjg4jjg7zjgq/jg7PjgIIKQGRhdGFjbGFzcwpjbGFzcyBUb2tlbjoKICAgIGtpbmQ6IHN0cgogICAgdGV4dDogc3RyCiAgICBwb3M6IGludAoKCiMg5byP44OO44O844OJ44CCa2luZCDjgaflrp/kvZPjgpLorZjliKXjgZnjgovjgIIKQGRhdGFjbGFzcwpjbGFzcyBFeHByTm9kZToKICAgIGtpbmQ6IHN0ciAgICAgICAgIyAibGl0IiB8ICJ2YXIiIHwgImJpbiIgfCAibmVnIgogICAgdmFsdWU6IGludCAgICAgICAjIGxpdCDjga7lgKQKICAgIG5hbWU6IHN0ciAgICAgICAgIyB2YXIg44Gu5ZCN5YmNCiAgICBvcDogc3RyICAgICAgICAgICMgYmluIOOBrua8lOeul+WtkAogICAgbGVmdDogaW50ICAgICAgICAjIOWtkOODjuODvOODiSBpbmRleAogICAgcmlnaHQ6IGludCAgICAgICAjIOWtkOODjuODvOODiSBpbmRleAoKCiMg5paH44OO44O844OJ44CCa2luZCDjgaflrp/kvZPjgpLorZjliKXjgZnjgovjgIIKQGRhdGFjbGFzcwpjbGFzcyBTdG10Tm9kZToKICAgIGtpbmQ6IHN0ciAgICAgICAgIyAibGV0IiB8ICJhc3NpZ24iIHwgInByaW50IgogICAgbmFtZTogc3RyICAgICAgICAjIOWkieaVsOWQje+8iHByaW50IOOBp+OBr+acquS9v+eUqO+8iQogICAgZXhwcl9pbmRleDogaW50ICAjIOW8j+ODjuODvOODiSBpbmRleAoKZGVmIHRva2VuaXplKGxpbmVzOiBsaXN0W3N0cl0pIC0+IGxpc3RbVG9rZW5dOgogICAgdG9rZW5zOiBsaXN0W1Rva2VuXSA9IFtdCiAgICBsaW5lX2luZGV4OiBpbnQgPSAwCiAgICB3aGlsZSBsaW5lX2luZGV4IDwgbGVuKGxpbmVzKToKICAgICAgICBzb3VyY2U6IHN0ciA9IGxpbmVzW2xpbmVfaW5kZXhdCiAgICAgICAgaTogaW50ID0gMAogICAgICAgIG46IGludCA9IGxlbihzb3VyY2UpCiAgICAgICAgd2hpbGUgaSA8IG46CiAgICAgICAgICAgIGNoOiBzdHIgPSBzb3VyY2VbaTppICsgMV0KCiAgICAgICAgICAgIGlmIGNoID09ICIgIjoKICAgICAgICAgICAgICAgIGkgKz0gMQogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIGlmIGNoID09ICIrIjoKICAgICAgICAgICAgICAgIHRva2Vucy5hcHBlbmQoVG9rZW4oIlBMVVMiLCBjaCwgaSkpCiAgICAgICAgICAgICAgICBpICs9IDEKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICBpZiBjaCA9PSAiLSI6CiAgICAgICAgICAgICAgICB0b2tlbnMuYXBwZW5kKFRva2VuKCJNSU5VUyIsIGNoLCBpKSkKICAgICAgICAgICAgICAgIGkgKz0gMQogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIGlmIGNoID09ICIqIjoKICAgICAgICAgICAgICAgIHRva2Vucy5hcHBlbmQoVG9rZW4oIlNUQVIiLCBjaCwgaSkpCiAgICAgICAgICAgICAgICBpICs9IDEKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICBpZiBjaCA9PSAiLyI6CiAgICAgICAgICAgICAgICB0b2tlbnMuYXBwZW5kKFRva2VuKCJTTEFTSCIsIGNoLCBpKSkKICAgICAgICAgICAgICAgIGkgKz0gMQogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIGlmIGNoID09ICIoIjoKICAgICAgICAgICAgICAgIHRva2Vucy5hcHBlbmQoVG9rZW4oIkxQQVJFTiIsIGNoLCBpKSkKICAgICAgICAgICAgICAgIGkgKz0gMQogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIGlmIGNoID09ICIpIjoKICAgICAgICAgICAgICAgIHRva2Vucy5hcHBlbmQoVG9rZW4oIlJQQVJFTiIsIGNoLCBpKSkKICAgICAgICAgICAgICAgIGkgKz0gMQogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIGlmIGNoID09ICI9IjoKICAgICAgICAgICAgICAgIHRva2Vucy5hcHBlbmQoVG9rZW4oIkVRVUFMIiwgY2gsIGkpKQogICAgICAgICAgICAgICAgaSArPSAxCiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgaWYgY2guaXNkaWdpdCgpOgogICAgICAgICAgICAgICAgc3RhcnQ6IGludCA9IGkKICAgICAgICAgICAgICAgIHdoaWxlIGkgPCBuIGFuZCBzb3VyY2VbaTppICsgMV0uaXNkaWdpdCgpOgogICAgICAgICAgICAgICAgICAgIGkgKz0gMQogICAgICAgICAgICAgICAgdGV4dDogc3RyID0gc291cmNlW3N0YXJ0OmldCiAgICAgICAgICAgICAgICB0b2tlbnMuYXBwZW5kKFRva2VuKCJOVU1CRVIiLCB0ZXh0LCBzdGFydCkpCiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgaWYgY2guaXNhbHBoYSgpIG9yIGNoID09ICJfIjoKICAgICAgICAgICAgICAgIHN0YXJ0ID0gaQogICAgICAgICAgICAgICAgd2hpbGUgaSA8IG4gYW5kICgoc291cmNlW2k6aSArIDFdLmlzYWxwaGEoKSBvciBzb3VyY2VbaTppICsgMV0gPT0gIl8iKSBvciBzb3VyY2VbaTppICsgMV0uaXNkaWdpdCgpKToKICAgICAgICAgICAgICAgICAgICBpICs9IDEKICAgICAgICAgICAgICAgIHRleHQgPSBzb3VyY2Vbc3RhcnQ6aV0KICAgICAgICAgICAgICAgIGlmIHRleHQgPT0gImxldCI6CiAgICAgICAgICAgICAgICAgICAgdG9rZW5zLmFwcGVuZChUb2tlbigiTEVUIiwgdGV4dCwgc3RhcnQpKQogICAgICAgICAgICAgICAgZWxpZiB0ZXh0ID09ICJwcmludCI6CiAgICAgICAgICAgICAgICAgICAgdG9rZW5zLmFwcGVuZChUb2tlbigiUFJJTlQiLCB0ZXh0LCBzdGFydCkpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHRva2Vucy5hcHBlbmQoVG9rZW4oIklERU5UIiwgdGV4dCwgc3RhcnQpKQogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigidG9rZW5pemUgZXJyb3IgYXQgbGluZT0iICsgc3RyKGxpbmVfaW5kZXgpICsgIiBwb3M9IiArIHN0cihpKSArICIgY2g9IiArIGNoKQoKICAgICAgICB0b2tlbnMuYXBwZW5kKFRva2VuKCJORVdMSU5FIiwgIiIsIG4pKQogICAgICAgIGxpbmVfaW5kZXggKz0gMQoKICAgIHRva2Vucy5hcHBlbmQoVG9rZW4oIkVPRiIsICIiLCBsZW4obGluZXMpKSkKICAgIHJldHVybiB0b2tlbnMKCgpjbGFzcyBQYXJzZXI6CiAgICBkZWYgbmV3X2V4cHJfbm9kZXMoc2VsZikgLT4gbGlzdFtFeHByTm9kZV06CiAgICAgICAgbm9kZXM6IGxpc3RbRXhwck5vZGVdID0gW10KICAgICAgICByZXR1cm4gbm9kZXMKCiAgICBkZWYgX19pbml0X18oc2VsZiwgdG9rZW5zOiBsaXN0W1Rva2VuXSkgLT4gTm9uZToKICAgICAgICBzZWxmLnRva2VuczogbGlzdFtUb2tlbl0gPSB0b2tlbnMKICAgICAgICBzZWxmLnBvczogaW50ID0gMAogICAgICAgIHNlbGYuZXhwcl9ub2RlczogbGlzdFtFeHByTm9kZV0gPSBzZWxmLm5ld19leHByX25vZGVzKCkKCiAgICBkZWYgcGVla19raW5kKHNlbGYpIC0+IHN0cjoKICAgICAgICByZXR1cm4gc2VsZi50b2tlbnNbc2VsZi5wb3NdLmtpbmQKCiAgICBkZWYgbWF0Y2goc2VsZiwga2luZDogc3RyKSAtPiBib29sOgogICAgICAgIGlmIHNlbGYucGVla19raW5kKCkgPT0ga2luZDoKICAgICAgICAgICAgc2VsZi5wb3MgKz0gMQogICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBleHBlY3Qoc2VsZiwga2luZDogc3RyKSAtPiBUb2tlbjoKICAgICAgICBpZiBzZWxmLnBlZWtfa2luZCgpICE9IGtpbmQ6CiAgICAgICAgICAgIHQ6IFRva2VuID0gc2VsZi50b2tlbnNbc2VsZi5wb3NdCiAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigicGFyc2UgZXJyb3IgYXQgcG9zPSIgKyBzdHIodC5wb3MpICsgIiwgZXhwZWN0ZWQ9IiArIGtpbmQgKyAiLCBnb3Q9IiArIHQua2luZCkKICAgICAgICB0b2tlbjogVG9rZW4gPSBzZWxmLnRva2Vuc1tzZWxmLnBvc10KICAgICAgICBzZWxmLnBvcyArPSAxCiAgICAgICAgcmV0dXJuIHRva2VuCgogICAgZGVmIHNraXBfbmV3bGluZXMoc2VsZikgLT4gTm9uZToKICAgICAgICB3aGlsZSBzZWxmLm1hdGNoKCJORVdMSU5FIik6CiAgICAgICAgICAgIHBhc3MKCiAgICBkZWYgYWRkX2V4cHIoc2VsZiwgbm9kZTogRXhwck5vZGUpIC0+IGludDoKICAgICAgICBzZWxmLmV4cHJfbm9kZXMuYXBwZW5kKG5vZGUpCiAgICAgICAgcmV0dXJuIGxlbihzZWxmLmV4cHJfbm9kZXMpIC0gMQoKICAgIGRlZiBwYXJzZV9wcm9ncmFtKHNlbGYpIC0+IGxpc3RbU3RtdE5vZGVdOgogICAgICAgIHN0bXRzOiBsaXN0W1N0bXROb2RlXSA9IFtdCiAgICAgICAgc2VsZi5za2lwX25ld2xpbmVzKCkKICAgICAgICB3aGlsZSBzZWxmLnBlZWtfa2luZCgpICE9ICJFT0YiOgogICAgICAgICAgICBzdG10OiBTdG10Tm9kZSA9IHNlbGYucGFyc2Vfc3RtdCgpCiAgICAgICAgICAgIHN0bXRzLmFwcGVuZChzdG10KQogICAgICAgICAgICBzZWxmLnNraXBfbmV3bGluZXMoKQogICAgICAgIHJldHVybiBzdG10cwoKICAgIGRlZiBwYXJzZV9zdG10KHNlbGYpIC0+IFN0bXROb2RlOgogICAgICAgIGlmIHNlbGYubWF0Y2goIkxFVCIpOgogICAgICAgICAgICBsZXRfbmFtZTogc3RyID0gc2VsZi5leHBlY3QoIklERU5UIikudGV4dAogICAgICAgICAgICBzZWxmLmV4cGVjdCgiRVFVQUwiKQogICAgICAgICAgICBsZXRfZXhwcl9pbmRleDogaW50ID0gc2VsZi5wYXJzZV9leHByKCkKICAgICAgICAgICAgcmV0dXJuIFN0bXROb2RlKCJsZXQiLCBsZXRfbmFtZSwgbGV0X2V4cHJfaW5kZXgpCgogICAgICAgIGlmIHNlbGYubWF0Y2goIlBSSU5UIik6CiAgICAgICAgICAgIHByaW50X2V4cHJfaW5kZXg6IGludCA9IHNlbGYucGFyc2VfZXhwcigpCiAgICAgICAgICAgIHJldHVybiBTdG10Tm9kZSgicHJpbnQiLCAiIiwgcHJpbnRfZXhwcl9pbmRleCkKCiAgICAgICAgYXNzaWduX25hbWU6IHN0ciA9IHNlbGYuZXhwZWN0KCJJREVOVCIpLnRleHQKICAgICAgICBzZWxmLmV4cGVjdCgiRVFVQUwiKQogICAgICAgIGFzc2lnbl9leHByX2luZGV4OiBpbnQgPSBzZWxmLnBhcnNlX2V4cHIoKQogICAgICAgIHJldHVybiBTdG10Tm9kZSgiYXNzaWduIiwgYXNzaWduX25hbWUsIGFzc2lnbl9leHByX2luZGV4KQoKICAgIGRlZiBwYXJzZV9leHByKHNlbGYpIC0+IGludDoKICAgICAgICByZXR1cm4gc2VsZi5wYXJzZV9hZGQoKQoKICAgIGRlZiBwYXJzZV9hZGQoc2VsZikgLT4gaW50OgogICAgICAgIGxlZnQ6IGludCA9IHNlbGYucGFyc2VfbXVsKCkKICAgICAgICBkb25lOiBib29sID0gRmFsc2UKICAgICAgICB3aGlsZSBub3QgZG9uZToKICAgICAgICAgICAgaWYgc2VsZi5tYXRjaCgiUExVUyIpOgogICAgICAgICAgICAgICAgcmlnaHQ6IGludCA9IHNlbGYucGFyc2VfbXVsKCkKICAgICAgICAgICAgICAgIGxlZnQgPSBzZWxmLmFkZF9leHByKEV4cHJOb2RlKCJiaW4iLCAwLCAiIiwgIisiLCBsZWZ0LCByaWdodCkpCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBpZiBzZWxmLm1hdGNoKCJNSU5VUyIpOgogICAgICAgICAgICAgICAgcmlnaHQgPSBzZWxmLnBhcnNlX211bCgpCiAgICAgICAgICAgICAgICBsZWZ0ID0gc2VsZi5hZGRfZXhwcihFeHByTm9kZSgiYmluIiwgMCwgIiIsICItIiwgbGVmdCwgcmlnaHQpKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZG9uZSA9IFRydWUKICAgICAgICByZXR1cm4gbGVmdAoKICAgIGRlZiBwYXJzZV9tdWwoc2VsZikgLT4gaW50OgogICAgICAgIGxlZnQ6IGludCA9IHNlbGYucGFyc2VfdW5hcnkoKQogICAgICAgIGRvbmU6IGJvb2wgPSBGYWxzZQogICAgICAgIHdoaWxlIG5vdCBkb25lOgogICAgICAgICAgICBpZiBzZWxmLm1hdGNoKCJTVEFSIik6CiAgICAgICAgICAgICAgICByaWdodDogaW50ID0gc2VsZi5wYXJzZV91bmFyeSgpCiAgICAgICAgICAgICAgICBsZWZ0ID0gc2VsZi5hZGRfZXhwcihFeHByTm9kZSgiYmluIiwgMCwgIiIsICIqIiwgbGVmdCwgcmlnaHQpKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgaWYgc2VsZi5tYXRjaCgiU0xBU0giKToKICAgICAgICAgICAgICAgIHJpZ2h0ID0gc2VsZi5wYXJzZV91bmFyeSgpCiAgICAgICAgICAgICAgICBsZWZ0ID0gc2VsZi5hZGRfZXhwcihFeHByTm9kZSgiYmluIiwgMCwgIiIsICIvIiwgbGVmdCwgcmlnaHQpKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZG9uZSA9IFRydWUKICAgICAgICByZXR1cm4gbGVmdAoKICAgIGRlZiBwYXJzZV91bmFyeShzZWxmKSAtPiBpbnQ6CiAgICAgICAgaWYgc2VsZi5tYXRjaCgiTUlOVVMiKToKICAgICAgICAgICAgY2hpbGQ6IGludCA9IHNlbGYucGFyc2VfdW5hcnkoKQogICAgICAgICAgICByZXR1cm4gc2VsZi5hZGRfZXhwcihFeHByTm9kZSgibmVnIiwgMCwgIiIsICIiLCBjaGlsZCwgLTEpKQogICAgICAgIHJldHVybiBzZWxmLnBhcnNlX3ByaW1hcnkoKQoKICAgIGRlZiBwYXJzZV9wcmltYXJ5KHNlbGYpIC0+IGludDoKICAgICAgICBpZiBzZWxmLm1hdGNoKCJOVU1CRVIiKToKICAgICAgICAgICAgdG9rZW5fbnVtOiBUb2tlbiA9IHNlbGYudG9rZW5zW3NlbGYucG9zIC0gMV0KICAgICAgICAgICAgcGFyc2VkX3ZhbHVlOiBpbnQgPSAwCiAgICAgICAgICAgIGlkeDogaW50ID0gMAogICAgICAgICAgICB3aGlsZSBpZHggPCBsZW4odG9rZW5fbnVtLnRleHQpOgogICAgICAgICAgICAgICAgY2g6IHN0ciA9IHRva2VuX251bS50ZXh0W2lkeDppZHggKyAxXQogICAgICAgICAgICAgICAgcGFyc2VkX3ZhbHVlID0gcGFyc2VkX3ZhbHVlICogMTAgKyBvcmQoY2gpIC0gb3JkKCIwIikKICAgICAgICAgICAgICAgIGlkeCArPSAxCiAgICAgICAgICAgIHJldHVybiBzZWxmLmFkZF9leHByKEV4cHJOb2RlKCJsaXQiLCBwYXJzZWRfdmFsdWUsICIiLCAiIiwgLTEsIC0xKSkKCiAgICAgICAgaWYgc2VsZi5tYXRjaCgiSURFTlQiKToKICAgICAgICAgICAgdG9rZW5faWRlbnQ6IFRva2VuID0gc2VsZi50b2tlbnNbc2VsZi5wb3MgLSAxXQogICAgICAgICAgICByZXR1cm4gc2VsZi5hZGRfZXhwcihFeHByTm9kZSgidmFyIiwgMCwgdG9rZW5faWRlbnQudGV4dCwgIiIsIC0xLCAtMSkpCgogICAgICAgIGlmIHNlbGYubWF0Y2goIkxQQVJFTiIpOgogICAgICAgICAgICBleHByX2luZGV4OiBpbnQgPSBzZWxmLnBhcnNlX2V4cHIoKQogICAgICAgICAgICBzZWxmLmV4cGVjdCgiUlBBUkVOIikKICAgICAgICAgICAgcmV0dXJuIGV4cHJfaW5kZXgKCiAgICAgICAgdCA9IHNlbGYudG9rZW5zW3NlbGYucG9zXQogICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigicHJpbWFyeSBwYXJzZSBlcnJvciBhdCBwb3M9IiArIHN0cih0LnBvcykgKyAiIGdvdD0iICsgdC5raW5kKQoKCmRlZiBldmFsX2V4cHIoZXhwcl9pbmRleDogaW50LCBleHByX25vZGVzOiBsaXN0W0V4cHJOb2RlXSwgZW52OiBkaWN0W3N0ciwgaW50XSkgLT4gaW50OgogICAgIyBDKyvlgbTjgacgZW52IOOBjCBjb25zdCDmibHjgYTjgavjgarjgovjga7jgpLpgb/jgZHjgovjgZ/jgoHjga7jg4Djg5/jg7zmm7jjgY3ovrzjgb/jgIIKICAgIGlmIEZhbHNlOgogICAgICAgIGVudlsiX19kdW1teV9fIl0gPSAwCgogICAgbm9kZTogRXhwck5vZGUgPSBleHByX25vZGVzW2V4cHJfaW5kZXhdCgogICAgaWYgbm9kZS5raW5kID09ICJsaXQiOgogICAgICAgIHJldHVybiBub2RlLnZhbHVlCgogICAgaWYgbm9kZS5raW5kID09ICJ2YXIiOgogICAgICAgIGlmIG5vdCAobm9kZS5uYW1lIGluIGVudik6CiAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigidW5kZWZpbmVkIHZhcmlhYmxlOiAiICsgbm9kZS5uYW1lKQogICAgICAgIHJldHVybiBlbnZbbm9kZS5uYW1lXQoKICAgIGlmIG5vZGUua2luZCA9PSAibmVnIjoKICAgICAgICByZXR1cm4gLWV2YWxfZXhwcihub2RlLmxlZnQsIGV4cHJfbm9kZXMsIGVudikKCiAgICBpZiBub2RlLmtpbmQgPT0gImJpbiI6CiAgICAgICAgbGhzOiBpbnQgPSBldmFsX2V4cHIobm9kZS5sZWZ0LCBleHByX25vZGVzLCBlbnYpCiAgICAgICAgcmhzOiBpbnQgPSBldmFsX2V4cHIobm9kZS5yaWdodCwgZXhwcl9ub2RlcywgZW52KQogICAgICAgIGlmIG5vZGUub3AgPT0gIisiOgogICAgICAgICAgICByZXR1cm4gbGhzICsgcmhzCiAgICAgICAgaWYgbm9kZS5vcCA9PSAiLSI6CiAgICAgICAgICAgIHJldHVybiBsaHMgLSByaHMKICAgICAgICBpZiBub2RlLm9wID09ICIqIjoKICAgICAgICAgICAgcmV0dXJuIGxocyAqIHJocwogICAgICAgIGlmIG5vZGUub3AgPT0gIi8iOgogICAgICAgICAgICBpZiByaHMgPT0gMDoKICAgICAgICAgICAgICAgIHJhaXNlIFJ1bnRpbWVFcnJvcigiZGl2aXNpb24gYnkgemVybyIpCiAgICAgICAgICAgICMg44Of44OL6KiA6Kqe44Gn44Gv5pW05pWw6Zmk566X44KS5o6h55So44GZ44KL44CCCiAgICAgICAgICAgIHJldHVybiBsaHMgLy8gcmhzCiAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCJ1bmtub3duIG9wZXJhdG9yOiAiICsgbm9kZS5vcCkKCiAgICByYWlzZSBSdW50aW1lRXJyb3IoInVua25vd24gbm9kZSBraW5kOiAiICsgbm9kZS5raW5kKQoKCmRlZiBleGVjdXRlKHN0bXRzOiBsaXN0W1N0bXROb2RlXSwgZXhwcl9ub2RlczogbGlzdFtFeHByTm9kZV0sIHRyYWNlOiBib29sKSAtPiBpbnQ6CiAgICBlbnY6IGRpY3Rbc3RyLCBpbnRdID0ge30KICAgIGNoZWNrc3VtOiBpbnQgPSAwCiAgICBwcmludGVkOiBpbnQgPSAwCgogICAgZm9yIHN0bXQgaW4gc3RtdHM6CiAgICAgICAgaWYgc3RtdC5raW5kID09ICJsZXQiOgogICAgICAgICAgICBlbnZbc3RtdC5uYW1lXSA9IGV2YWxfZXhwcihzdG10LmV4cHJfaW5kZXgsIGV4cHJfbm9kZXMsIGVudikKICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgaWYgc3RtdC5raW5kID09ICJhc3NpZ24iOgogICAgICAgICAgICBpZiBub3QgKHN0bXQubmFtZSBpbiBlbnYpOgogICAgICAgICAgICAgICAgcmFpc2UgUnVudGltZUVycm9yKCJhc3NpZ24gdG8gdW5kZWZpbmVkIHZhcmlhYmxlOiAiICsgc3RtdC5uYW1lKQogICAgICAgICAgICBlbnZbc3RtdC5uYW1lXSA9IGV2YWxfZXhwcihzdG10LmV4cHJfaW5kZXgsIGV4cHJfbm9kZXMsIGVudikKICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgdmFsdWU6IGludCA9IGV2YWxfZXhwcihzdG10LmV4cHJfaW5kZXgsIGV4cHJfbm9kZXMsIGVudikKICAgICAgICBpZiB0cmFjZToKICAgICAgICAgICAgcHJpbnQodmFsdWUpCiAgICAgICAgbm9ybTogaW50ID0gdmFsdWUgJSAxMDAwMDAwMDA3CiAgICAgICAgaWYgbm9ybSA8IDA6CiAgICAgICAgICAgIG5vcm0gKz0gMTAwMDAwMDAwNwogICAgICAgIGNoZWNrc3VtID0gKGNoZWNrc3VtICogMTMxICsgbm9ybSkgJSAxMDAwMDAwMDA3CiAgICAgICAgcHJpbnRlZCArPSAxCgogICAgaWYgdHJhY2U6CiAgICAgICAgcHJpbnQoInByaW50ZWQ6IiwgcHJpbnRlZCkKICAgIHJldHVybiBjaGVja3N1bQoKCmRlZiBidWlsZF9iZW5jaG1hcmtfc291cmNlKHZhcl9jb3VudDogaW50LCBsb29wczogaW50KSAtPiBsaXN0W3N0cl06CiAgICBsaW5lczogbGlzdFtzdHJdID0gW10KCiAgICAjIOWIneacn+WkieaVsOOCkuWuo+iogOOAggogICAgZm9yIGkgaW4gcmFuZ2UodmFyX2NvdW50KToKICAgICAgICBsaW5lcy5hcHBlbmQoImxldCB2IiArIHN0cihpKSArICIgPSAiICsgc3RyKGkgKyAxKSkKCiAgICAjIOeul+ihk+W8j+OCkuWkp+mHj+OBq+ipleS+oeOBleOBm+OCi+OAggogICAgZm9yIGkgaW4gcmFuZ2UobG9vcHMpOgogICAgICAgIHg6IGludCA9IGkgJSB2YXJfY291bnQKICAgICAgICB5OiBpbnQgPSAoaSArIDMpICUgdmFyX2NvdW50CiAgICAgICAgYzE6IGludCA9IChpICUgNykgKyAxCiAgICAgICAgYzI6IGludCA9IChpICUgMTEpICsgMgogICAgICAgIGxpbmVzLmFwcGVuZCgKICAgICAgICAgICAgInYiICsgc3RyKHgpICsgIiA9ICh2IiArIHN0cih4KSArICIgKiAiICsgc3RyKGMxKSArICIgKyB2IiArIHN0cih5KSArICIgKyAxMDAwMCkgLyAiICsgc3RyKGMyKQogICAgICAgICkKICAgICAgICBpZiBpICUgOTcgPT0gMDoKICAgICAgICAgICAgbGluZXMuYXBwZW5kKCJwcmludCB2IiArIHN0cih4KSkKCiAgICAjIOacgOe1guWApOOCkuOBvuOBqOOCgeOBpuWHuuWKm+OAggogICAgbGluZXMuYXBwZW5kKCJwcmludCAodjAgKyB2MSArIHYyICsgdjMpIikKICAgIHJldHVybiBsaW5lcwoKCmRlZiBydW5fZGVtbygpIC0+IE5vbmU6CiAgICBkZW1vX2xpbmVzOiBsaXN0W3N0cl0gPSBbXQogICAgZGVtb19saW5lcy5hcHBlbmQoImxldCBhID0gMTAiKQogICAgZGVtb19saW5lcy5hcHBlbmQoImxldCBiID0gMyIpCiAgICBkZW1vX2xpbmVzLmFwcGVuZCgiYSA9IChhICsgYikgKiAyIikKICAgIGRlbW9fbGluZXMuYXBwZW5kKCJwcmludCBhIikKICAgIGRlbW9fbGluZXMuYXBwZW5kKCJwcmludCBhIC8gYiIpCgogICAgdG9rZW5zOiBsaXN0W1Rva2VuXSA9IHRva2VuaXplKGRlbW9fbGluZXMpCiAgICBwYXJzZXI6IFBhcnNlciA9IFBhcnNlcih0b2tlbnMpCiAgICBzdG10czogbGlzdFtTdG10Tm9kZV0gPSBwYXJzZXIucGFyc2VfcHJvZ3JhbSgpCiAgICBjaGVja3N1bTogaW50ID0gZXhlY3V0ZShzdG10cywgcGFyc2VyLmV4cHJfbm9kZXMsIFRydWUpCiAgICBwcmludCgiZGVtb19jaGVja3N1bToiLCBjaGVja3N1bSkKCgpkZWYgcnVuX2JlbmNobWFyaygpIC0+IE5vbmU6CiAgICBzb3VyY2VfbGluZXM6IGxpc3Rbc3RyXSA9IGJ1aWxkX2JlbmNobWFya19zb3VyY2UoMzIsIDEyMDAwMCkKICAgIHN0YXJ0OiBmbG9hdCA9IHBlcmZfY291bnRlcigpCiAgICB0b2tlbnM6IGxpc3RbVG9rZW5dID0gdG9rZW5pemUoc291cmNlX2xpbmVzKQogICAgcGFyc2VyOiBQYXJzZXIgPSBQYXJzZXIodG9rZW5zKQogICAgc3RtdHM6IGxpc3RbU3RtdE5vZGVdID0gcGFyc2VyLnBhcnNlX3Byb2dyYW0oKQogICAgY2hlY2tzdW06IGludCA9IGV4ZWN1dGUoc3RtdHMsIHBhcnNlci5leHByX25vZGVzLCBGYWxzZSkKICAgIGVsYXBzZWQ6IGZsb2F0ID0gcGVyZl9jb3VudGVyKCkgLSBzdGFydAoKICAgIHByaW50KCJ0b2tlbl9jb3VudDoiLCBsZW4odG9rZW5zKSkKICAgIHByaW50KCJleHByX2NvdW50OiIsIGxlbihwYXJzZXIuZXhwcl9ub2RlcykpCiAgICBwcmludCgic3RtdF9jb3VudDoiLCBsZW4oc3RtdHMpKQogICAgcHJpbnQoImNoZWNrc3VtOiIsIGNoZWNrc3VtKQogICAgcHJpbnQoImVsYXBzZWRfc2VjOiIsIGVsYXBzZWQpCgoKZGVmIG1haW4oKSAtPiBOb25lOgogICAgcnVuX2RlbW8oKQogICAgcnVuX2JlbmNobWFyaygpCgoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIG1haW4oKQo="

        // main は埋め込み Python を実行するエントリポイント。
        @JvmStatic
        fun main(args: Array<String>) {
            val code: Int = PyRuntime.runEmbeddedPython(PYTRA_EMBEDDED_SOURCE_BASE64, args)
            kotlin.system.exitProcess(code)
        }
    }
}
