<a href="../../docs-ja/todo-history/20260221.md">
  <img alt="Read in Japanese" src="https://img.shields.io/badge/docs-日本語-2563EB?style=flat-square">
</a>

# TODO History (2026-02-21)

## 2026-02-21 Completed: CodeEmitter / Hooks migration batch (moved from `docs-ja/todo.md`)

Completed batch included:
- Hook migration for major `render_expr` branches
- Helper extraction and shared `CodeEmitter` consolidation
- Regression checks for transpile/selfhost paths

## 2026-02-21 Completed: selfhost stub cleanup (multi-file completed)

Completed:
- Multi-file-related selfhost stub cleanup and sync
- Build/stability checks after cleanup

## 2026-02-21 Completed: stabilize selfhost stage2 execution path and diff checks

Completed:
- Stabilized stage2 execution route
- Improved reproducibility of diff-verification workflow

## 2026-02-21 Completed: selfhost stub cleanup (additional)

Completed additional reductions of temporary selfhost-only replacements.

## 2026-02-21 Completed: selfhost stub cleanup (`load_cpp_hooks`)

Completed:
- Additional cleanup around `load_cpp_hooks` replacement path
- Regression verification for selfhost build/execution

## 2026-02-21 Completed: selfhost direct-conversion Compare-shape correction

Completed:
- Fixed compare-shape degradation in direct selfhost conversion route
- Added/ran relevant regression checks

## 2026-02-21 Completed: resolve lead cluster in 2-stage selfhost self-conversion

Completed:
- Cleared initial blocker cluster in stage2 self-conversion sequence

## 2026-02-21 Completed: type-normalization regression fix in selfhost direct conversion

Completed:
- Fixed normalization regression and revalidated representative checks

## 2026-02-21 Completed: py2cpp Call-branch hook migration

1. Moved `dict.get/list.* / set.*` call resolution from direct `src/py2cpp.py` branches into runtime-call hook handling (`src/hooks/cpp/hooks/cpp_hooks.py`), reducing hardcoded branches in `py2cpp.py`.

## 2026-02-21 Completed: pass-through notation

1. Specified and minimally implemented transpile-time pass-through notation (`# Pytra::cpp` / `# Pytra::pass`).
- Added rules to `docs/spec/spec-east.md` for placement, indentation, multi-block concatenation, and precedence against docstring-comment conversion.
- Implemented EAST-side storage via `leading_trivia` comment text and C++ emitter expansion path.
- Added minimal fixture (`test/fixtures/core/pass_through_comment.py`) and unit test proving no behavior impact in Python execution and proper C++ line emission.

## Migration snapshot: 2026-02-21 (before `todo.md` reorganization)

This historical snapshot section is retained to preserve progression context before TODO reorganization.
